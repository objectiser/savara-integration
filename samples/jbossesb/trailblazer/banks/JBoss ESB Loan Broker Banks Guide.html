<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List
href="JBoss%20ESB%20Loan%20Broker%20Banks%20Guide_files/filelist.xml">
<title>BANKS FOR THE LOANBROKER DEMO</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="country-region"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="Street"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="address"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="place"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="City"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="State"/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>kstam</o:Author>
  <o:LastAuthor>kstam</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>7</o:TotalTime>
  <o:Created>2006-08-03T14:42:00Z</o:Created>
  <o:LastSaved>2006-08-03T14:42:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>743</o:Words>
  <o:Characters>4237</o:Characters>
  <o:Company>JBoss, Inc.</o:Company>
  <o:Lines>35</o:Lines>
  <o:Paragraphs>9</o:Paragraphs>
  <o:CharactersWithSpaces>4971</o:CharactersWithSpaces>
  <o:Version>11.6568</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-link:"Heading 1 Char";
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:Arial;
	mso-font-kerning:16.0pt;}
h2
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	font-family:Arial;
	font-style:italic;}
h3
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:13.0pt;
	font-family:Arial;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-locked:yes;
	mso-style-link:"Heading 1";
	mso-ansi-font-size:16.0pt;
	mso-bidi-font-size:16.0pt;
	font-family:Arial;
	mso-ascii-font-family:Arial;
	mso-hansi-font-family:Arial;
	mso-bidi-font-family:Arial;
	mso-font-kerning:16.0pt;
	mso-ansi-language:EN-US;
	mso-fareast-language:EN-US;
	mso-bidi-language:AR-SA;
	font-weight:bold;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<h1>JBoss ESB Loan Broker Banks Guide</h1>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>By: Kurt Stam (<a href="mailto:kurt.stam@jboss.com">kurt.stam@jboss.com</a>)</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>JBoss ESB JBoss Labs Home Page: <a
href="http://labs.jboss.com/portal/jbossesb">http://labs.jboss.com/portal/jbossesb</a></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>JBoss ESB Developer Community Forums: <a
href="http://www.jboss.com/index.html?module=bb&amp;op=viewforum&amp;f=220">http://www.jboss.com/index.html?module=bb&amp;op=viewforum&amp;f=220</a></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>########################################################################</p>

<p class=MsoNormal># JBoss, Home of Professional Open Source</p>

<p class=MsoNormal># Copyright 2006, JBoss Inc., and individual contributors as
indicated</p>

<p class=MsoNormal># <span class=GramE>by</span> the @authors tag. See the
copyright.txt in the distribution for a</p>

<p class=MsoNormal># <span class=GramE>full</span> listing of individual
contributors.</p>

<p class=MsoNormal>#</p>

<p class=MsoNormal># <span class=GramE>This</span> is free software; you can
redistribute it and/or modify it</p>

<p class=MsoNormal># <span class=GramE>under</span> the terms of the GNU Lesser
General Public License as</p>

<p class=MsoNormal># published by the Free Software Foundation; either version
2.1 of</p>

<p class=MsoNormal># <span class=GramE>the</span> License, or (at your option)
any later version.</p>

<p class=MsoNormal>#</p>

<p class=MsoNormal># <span class=GramE>This</span> software is distributed in
the hope that it will be useful,</p>

<p class=MsoNormal># <span class=GramE>but</span> WITHOUT ANY WARRANTY; without
even the implied warranty of</p>

<p class=MsoNormal><span class=GramE># MERCHANTABILITY or FITNESS FOR A
PARTICULAR PURPOSE.</span> See the GNU</p>

<p class=MsoNormal><span class=GramE># Lesser General Public License for more
details.</span></p>

<p class=MsoNormal>#</p>

<p class=MsoNormal># <span class=GramE>You</span> should have received a copy
of the GNU Lesser General Public</p>

<p class=MsoNormal># License along with this software; if not, write to the
Free</p>

<p class=MsoNormal># Software Foundation, Inc., <st1:Street w:st="on"><st1:address
 w:st="on">51 Franklin St</st1:address></st1:Street>, Fifth Floor, <st1:place
w:st="on"><st1:City w:st="on">Boston</st1:City>, <st1:State w:st="on">MA</st1:State></st1:place></p>

<p class=MsoNormal># 02110-1301 <st1:place w:st="on"><st1:country-region w:st="on">USA</st1:country-region></st1:place>,
or see the FSF site: http://www.fsf.org.</p>

<p class=MsoNormal>########################################################################</p>

<p class=MsoNormal><b><span style='font-size:16.0pt;font-family:Arial;
background:white;mso-highlight:white;mso-font-kerning:16.0pt'><o:p>&nbsp;</o:p></span></b></p>

<p class=MsoNormal><b><span style='font-size:16.0pt;font-family:Arial;
background:white;mso-highlight:white;mso-font-kerning:16.0pt'><o:p>&nbsp;</o:p></span></b></p>

<b><span style='font-size:16.0pt;font-family:Arial;mso-fareast-font-family:
"Times New Roman";background:white;mso-highlight:white;mso-font-kerning:16.0pt;
mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA'><br
clear=all style='page-break-before:always'>
</span></b>

<p class=MsoNormal><span class=Heading1Char><span style='font-size:16.0pt;
background:white;mso-highlight:white'>1. Introduction</span></span><span
class=Heading1Char><span style='font-size:16.0pt'><o:p></o:p></span></span></p>

<p class=MsoNormal><span style='background:white;mso-highlight:white'>As part
of the Loan Broker Demo, the broker goes out to a few banks to obtain loan
quotes.</span></p>

<p class=MsoNormal><span style='background:white;mso-highlight:white'>This
folder contains two banks:</span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='background:white;mso-highlight:white'>1. <span
class=GramE>a</span> Flat File Based Bank, and</span></p>

<p class=MsoNormal><span style='background:white;mso-highlight:white'>2. <span
class=GramE>a</span> JMS Based bank.</span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='background:white;mso-highlight:white'>To make
the demo a little more interesting we have the banks use two different
protocols (flat file and JMS), and two</span> <span style='background:white;
mso-highlight:white'>different message formats (<span class=SpellE>csv</span>,
xml). You can customize some of the configuration in the <span class=SpellE>bank.properties</span>
file. Not that</span> <span style='background:white;mso-highlight:white'>the
banks use to log4j.xml in the current directory. </span></p>

<h2><span style='background:white;mso-highlight:white'>2. Flat File Based Bank</span></h2>

<h3><span style='background:white;mso-highlight:white'>2.1 Starting the bank</span></h3>

<p class=MsoNormal><span style='background:white;mso-highlight:white'>The Flat
File Based Bank uses the property '<span class=SpellE>file.monitored.directory</span>'
which by default is set to 'C<span class=GramE>:\</span>Temp\<span
class=SpellE>BankInput</span>'.</span> <span style='background:white;
mso-highlight:white'>You can start this bank by typing:</span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
class=GramE><span style='font-size:10.0pt;font-family:"Courier New";background:
white;mso-highlight:white'>ant</span></span><span style='font-size:10.0pt;
font-family:"Courier New";background:white;mso-highlight:white'> <span
class=SpellE>runFileBank</span></span><span style='font-size:10.0pt;font-family:
"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New"'>* Not of caution, there is
no filter set in the <span class=SpellE>poller</span> code, so it will pick up
and try to move any files it finds.<o:p></o:p></span></p>

<h3><span style='background:white;mso-highlight:white'>2.2 Processing details</span></h3>

<p class=MsoNormal><span style='background:white;mso-highlight:white'>The <span
class=SpellE>FlatFilePollManager</span> monitors a directory specified in the
configuration. When a file arrives it</span> <span style='background:white;
mso-highlight:white'>tries to process the content assuming it contains one line
with loan request information.</span> <span style='background:white;mso-highlight:
white'>So for example the content of the file could read something like </span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";background:white;mso-highlight:
white'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";background:white;mso-highlight:
white'>23456890<span class=GramE>,3,4,20000,5</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='background:white;mso-highlight:white'>The order
of values needs to be <span class=SpellE>SocialSecurityNumber</span>, <span
class=SpellE>CreditScore</span>, <span class=SpellE>HistoryLength</span>
[month], <span class=SpellE>LoanAmount</span> [dollar],</span> <span
style='background:white;mso-highlight:white'>and finally the <span
class=SpellE>LoanTerm</span> [month]. The request will be processed and a <span
class=SpellE>BankQouteReply</span> is generated. The</span> <span
style='background:white;mso-highlight:white'>original file is moved to a
'processed' directory, and the <span class=SpellE>BankQuoteReply</span> is
serialized to an 'outgoing' directory from <span class=GramE>the it</span> can
be picked up by the system that dropped the request.</span></p>

<h3><span style='background:white;mso-highlight:white'>2.3 Testing</span></h3>

<p class=MsoNormal><span style='background:white;mso-highlight:white'>You can
test whether or not the bank is working by dropping a file in the monitored
directory (C:\Temp\BankInput).Let's say we</span> <span style='background:white;
mso-highlight:white'>use a file with name 'request.txt'. The file should be
ASCII and can contain the following line:</span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";background:white;mso-highlight:
white'>23456890<span class=GramE>,3,4,20000,5</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='background:white;mso-highlight:white'>The file
should get moved to the C:\Temp\BankInput\processed directory, and in the
C:\Temp\ <span class=SpellE>BankInput</span>\outgoing directory a reply file
should</span> <span style='background:white;mso-highlight:white'>appear with
the name 'reply_to_request.txt'. It should contain the line:</span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";background:white;mso-highlight:
white'>8.29<span class=GramE>,FileBasedBank</span>-1,0</span><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span class=GramE><span style='background:white;mso-highlight:
white'>which</span></span><span style='background:white;mso-highlight:white'>
means the </span><span class=SpellE><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman";
background:white;mso-highlight:white'>QuoteId</span></span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
mso-bidi-font-family:"Times New Roman";background:white;mso-highlight:white'>=FileBasedBank-1</span><span
style='background:white;mso-highlight:white'>, the </span><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
mso-bidi-font-family:"Times New Roman";background:white;mso-highlight:white'>interest=8.29</span><span
style='background:white;mso-highlight:white'> and the </span><span
class=SpellE><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New";mso-bidi-font-family:"Times New Roman";background:
white;mso-highlight:white'>errorCode</span></span><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman";
background:white;mso-highlight:white'>=0</span><span style='background:white;
mso-highlight:white'> (which means success). You can check the logging for</span>
<span style='background:white;mso-highlight:white'>additional details.</span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<h2><span style='background:white;mso-highlight:white'>3. JMS Based Bank</span></h2>

<h3><span style='background:white;mso-highlight:white'>3.1 Starting the bank</span></h3>

<p class=MsoNormal><span style='background:white;mso-highlight:white'>Before
starting the bank you need to bring up your JMS provider. For the example this
is the JBoss AS. We are using</span> <span style='background:white;mso-highlight:
white'>the default queues (C and D). The JMS bank uses the properties: <span
class=SpellE>jms.provider.url</span>, <span class=SpellE>jms.queue.in</span>
and <span class=SpellE>jms.queue.out</span>. By</span> <span style='background:
white;mso-highlight:white'>default these are set to '<span class=SpellE>localhost</span>',
'queue/C' and 'queue/D'. So, by default, it assumes <st1:place w:st="on"><st1:City
 w:st="on">JBoss</st1:City> <st1:State w:st="on">AS</st1:State></st1:place> is
running on the <span class=SpellE>localhost</span>.</span> <span
style='background:white;mso-highlight:white'>Next you can start the JMS Based
bank by typing:</span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
class=GramE><span style='font-size:10.0pt;font-family:"Courier New";background:
white;mso-highlight:white'>ant</span></span><span style='font-size:10.0pt;
font-family:"Courier New";background:white;mso-highlight:white'> <span
class=SpellE>runJMSBank</span></span><span style='font-size:10.0pt;font-family:
"Courier New"'><o:p></o:p></span></p>

<h3><span style='background:white;mso-highlight:white'>3.2 Processing details</span></h3>

<p class=MsoNormal><span style='background:white;mso-highlight:white'>The <span
class=SpellE>JMSManager</span> listens to an incoming queue (by default queue/C
on <span class=SpellE>localhost</span>). It consumes the</span> <span
style='background:white;mso-highlight:white'>message assuming it is a <span
class=SpellE>TextMessage</span>, and that the text is an XML structure that can
be marshaled</span> <span style='background:white;mso-highlight:white'>into a <span
class=SpellE>BankQuoteRequest</span>. The request will be processed and a <span
class=SpellE>BankQuote</span> Reply will be serialized to XML</span> <span
style='background:white;mso-highlight:white'>and send to the outgoing queue (by
default this is queue/D on <span class=SpellE>localhost</span>). If the
processing results</span> <span style='background:white;mso-highlight:white'>in
an error a <span class=SpellE>BankQuoteReply</span> with <span class=SpellE>ErrorCode</span>
other then 0 is send to the outgoing queue.</span></p>

<h3><span style='background:white;mso-highlight:white'>3.3 Testing</span></h3>

<p class=MsoNormal><span style='background:white;mso-highlight:white'>The unit
test <span class=SpellE>JMSProcessorTest</span> drops a <span class=SpellE>BankQuoteRequest</span>
Message on the queue/C of <span class=SpellE>localhost</span>. You can use</span></p>

<p class=MsoNormal><span class=GramE><span style='background:white;mso-highlight:
white'>this</span></span><span style='background:white;mso-highlight:white'>
test to check the health of the <span class=SpellE>JMSBank</span>. The tests
can be executed by typing</span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
class=GramE><span style='font-size:10.0pt;font-family:"Courier New";background:
white;mso-highlight:white'>ant</span></span><span style='font-size:10.0pt;
font-family:"Courier New";background:white;mso-highlight:white'> test</span><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<h1><span style='background:white;mso-highlight:white'>4. Finally</span></h1>

<p class=MsoNormal><span style='background:white;mso-highlight:white'>You are
now ready to run the larger Load Broker Demo itself.</span></p>

</div>

</body>

</html>
